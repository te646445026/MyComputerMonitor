<Window x:Class="MyComputerMonitor.WPF.Views.MemoryMonitorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ui="http://schemas.modernwpf.com/2019"
        xmlns:oxy="http://oxyplot.org/wpf"
        ui:WindowHelper.UseModernWindowStyle="True"
        Title="内存监控" Height="700" Width="1000"
        WindowStartupLocation="CenterScreen">
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- 标题栏 -->
        <Border Grid.Row="0" 
                Background="{DynamicResource SystemControlBackgroundChromeMediumBrush}"
                BorderBrush="{DynamicResource SystemControlForegroundBaseMediumLowBrush}"
                BorderThickness="0,0,0,1">
            <Grid Height="48">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- 标题 -->
                <StackPanel Grid.Column="0" 
                           Orientation="Horizontal" 
                           VerticalAlignment="Center"
                           Margin="16,0">
                    <TextBlock Text="🧠" 
                              FontSize="20" 
                              VerticalAlignment="Center"
                              Margin="0,0,8,0"/>
                    <TextBlock Text="内存监控" 
                              FontSize="16" 
                              FontWeight="SemiBold"
                              VerticalAlignment="Center"/>
                </StackPanel>
                
                <!-- 控制按钮 -->
                <StackPanel Grid.Column="2" 
                           Orientation="Horizontal"
                           VerticalAlignment="Center"
                           Margin="16,0">
                    <Button Content="🔄" 
                           Width="32" 
                           Height="32"
                           Margin="0,0,8,0"
                           Click="RefreshButton_Click"
                           ToolTip="刷新数据"/>
                    <ComboBox x:Name="TimeRangeComboBox"
                             Width="120"
                             SelectedIndex="2"
                             SelectionChanged="TimeRangeComboBox_SelectionChanged">
                        <ComboBoxItem Content="最近 5 分钟"/>
                        <ComboBoxItem Content="最近 15 分钟"/>
                        <ComboBoxItem Content="最近 30 分钟"/>
                        <ComboBoxItem Content="最近 1 小时"/>
                        <ComboBoxItem Content="最近 2 小时"/>
                    </ComboBox>
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- 主内容 -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <Grid Margin="16">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- 内存基本信息 -->
                <Border Grid.Row="0" 
                       Background="{DynamicResource SystemControlBackgroundAltHighBrush}"
                       BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}"
                       BorderThickness="1"
                       CornerRadius="8"
                       Margin="0,0,0,16"
                       Padding="16">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <StackPanel Grid.Column="0">
                            <TextBlock Text="内存信息" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,12"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <TextBlock Grid.Row="0" Grid.Column="0" Text="总内存：" Margin="0,0,8,4"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" x:Name="TotalMemoryTextBlock" Text="获取中..." Margin="0,0,0,4"/>
                                
                                <TextBlock Grid.Row="1" Grid.Column="0" Text="已用内存：" Margin="0,0,8,4"/>
                                <TextBlock Grid.Row="1" Grid.Column="1" x:Name="UsedMemoryTextBlock" Text="获取中..." Margin="0,0,0,4"/>
                                
                                <TextBlock Grid.Row="2" Grid.Column="0" Text="可用内存：" Margin="0,0,8,4"/>
                                <TextBlock Grid.Row="2" Grid.Column="1" x:Name="AvailableMemoryTextBlock" Text="获取中..." Margin="0,0,0,4"/>
                                
                                <TextBlock Grid.Row="3" Grid.Column="0" Text="内存频率：" Margin="0,0,8,4"/>
                                <TextBlock Grid.Row="3" Grid.Column="1" x:Name="MemorySpeedTextBlock" Text="获取中..." Margin="0,0,0,4"/>
                                
                                <TextBlock Grid.Row="4" Grid.Column="0" Text="内存类型：" Margin="0,0,8,4"/>
                                <TextBlock Grid.Row="4" Grid.Column="1" x:Name="MemoryTypeTextBlock" Text="获取中..." Margin="0,0,0,4"/>
                            </Grid>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="1">
                            <TextBlock Text="实时状态" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,12"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <TextBlock Grid.Row="0" Grid.Column="0" Text="使用率：" Margin="0,0,8,4"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" x:Name="MemoryUsageTextBlock" Text="0%" Margin="0,0,0,4"/>
                                
                                <TextBlock Grid.Row="1" Grid.Column="0" Text="提交内存：" Margin="0,0,8,4"/>
                                <TextBlock Grid.Row="1" Grid.Column="1" x:Name="CommittedMemoryTextBlock" Text="0 GB" Margin="0,0,0,4"/>
                                
                                <TextBlock Grid.Row="2" Grid.Column="0" Text="缓存内存：" Margin="0,0,8,4"/>
                                <TextBlock Grid.Row="2" Grid.Column="1" x:Name="CachedMemoryTextBlock" Text="0 GB" Margin="0,0,0,4"/>
                                
                                <TextBlock Grid.Row="3" Grid.Column="0" Text="页面文件：" Margin="0,0,8,4"/>
                                <TextBlock Grid.Row="3" Grid.Column="1" x:Name="PageFileTextBlock" Text="0 GB" Margin="0,0,0,4"/>
                                
                                <TextBlock Grid.Row="4" Grid.Column="0" Text="内核内存：" Margin="0,0,8,4"/>
                                <TextBlock Grid.Row="4" Grid.Column="1" x:Name="KernelMemoryTextBlock" Text="0 GB" Margin="0,0,0,4"/>
                            </Grid>
                        </StackPanel>
                    </Grid>
                </Border>
                
                <!-- 内存使用率历史图表 -->
                <Border Grid.Row="1" 
                       Background="{DynamicResource SystemControlBackgroundAltHighBrush}"
                       BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}"
                       BorderThickness="1"
                       CornerRadius="8"
                       Margin="0,0,0,16"
                       Padding="16">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <TextBlock Grid.Row="0"
                                  Text="内存使用率历史"
                                  FontSize="16"
                                  FontWeight="SemiBold"
                                  Margin="0,0,0,12"/>
                        
                        <oxy:PlotView Grid.Row="1" 
                                     x:Name="MemoryUsagePlot"
                                     Background="Transparent"
                                     MinHeight="200"/>
                    </Grid>
                </Border>
                
                <!-- 内存详细使用情况 -->
                <Border Grid.Row="2" 
                       Background="{DynamicResource SystemControlBackgroundAltHighBrush}"
                       BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}"
                       BorderThickness="1"
                       CornerRadius="8"
                       Margin="0,0,0,16"
                       Padding="16">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <TextBlock Grid.Row="0"
                                  Text="内存详细使用情况"
                                  FontSize="16"
                                  FontWeight="SemiBold"
                                  Margin="0,0,0,12"/>
                        
                        <oxy:PlotView Grid.Row="1" 
                                     x:Name="MemoryDetailPlot"
                                     Background="Transparent"
                                     MinHeight="200"/>
                    </Grid>
                </Border>
                
                <!-- 内存模块信息 -->
                <Border Grid.Row="3" 
                       Background="{DynamicResource SystemControlBackgroundAltHighBrush}"
                       BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}"
                       BorderThickness="1"
                       CornerRadius="8"
                       Margin="0,0,0,16"
                       Padding="16">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <TextBlock Grid.Row="0"
                                  Text="内存模块信息"
                                  FontSize="16"
                                  FontWeight="SemiBold"
                                  Margin="0,0,0,12"/>
                        
                        <DataGrid Grid.Row="1" 
                                 x:Name="MemoryModulesDataGrid" 
                                 MinHeight="200" 
                                 AutoGenerateColumns="False"
                                 CanUserAddRows="False" 
                                 CanUserDeleteRows="False" 
                                 IsReadOnly="True"
                                 GridLinesVisibility="Horizontal" 
                                 HeadersVisibility="Column">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="插槽" Binding="{Binding Slot}" Width="80"/>
                                <DataGridTextColumn Header="容量" Binding="{Binding Capacity}" Width="100"/>
                                <DataGridTextColumn Header="频率" Binding="{Binding Speed}" Width="100"/>
                                <DataGridTextColumn Header="类型" Binding="{Binding Type}" Width="80"/>
                                <DataGridTextColumn Header="制造商" Binding="{Binding Manufacturer}" Width="120"/>
                                <DataGridTextColumn Header="型号" Binding="{Binding PartNumber}" Width="*"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Border>
                
                <!-- 内存进程排行 -->
                <Border Grid.Row="4" 
                       Background="{DynamicResource SystemControlBackgroundAltHighBrush}"
                       BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}"
                       BorderThickness="1"
                       CornerRadius="8"
                       Padding="16">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <TextBlock Grid.Row="0"
                                  Text="内存使用排行（前10名）"
                                  FontSize="16"
                                  FontWeight="SemiBold"
                                  Margin="0,0,0,12"/>
                        
                        <DataGrid Grid.Row="1" 
                                 x:Name="MemoryProcessesDataGrid" 
                                 MinHeight="250" 
                                 AutoGenerateColumns="False"
                                 CanUserAddRows="False" 
                                 CanUserDeleteRows="False" 
                                 IsReadOnly="True"
                                 GridLinesVisibility="Horizontal" 
                                 HeadersVisibility="Column">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="进程名" Binding="{Binding ProcessName}" Width="*"/>
                                <DataGridTextColumn Header="PID" Binding="{Binding ProcessId}" Width="80"/>
                                <DataGridTextColumn Header="内存使用" Binding="{Binding MemoryUsage}" Width="120"/>
                                <DataGridTextColumn Header="工作集" Binding="{Binding WorkingSet}" Width="120"/>
                                <DataGridTextColumn Header="私有字节" Binding="{Binding PrivateBytes}" Width="120"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Border>
                
            </Grid>
        </ScrollViewer>
    </Grid>
</Window>